---
name: haproxy
packages:
  - haproxy

templates:
  haproxy.config.erb:        config/haproxy.config
  haproxy_ctl:               bin/haproxy_ctl
  monit_debugger:            bin/monit_debugger
  helpers/ctl_setup.sh:      helpers/ctl_setup.sh
  helpers/ctl_utils.sh:      helpers/ctl_utils.sh
  properties.sh.erb:    data/properties.sh

properties:
  ha_proxy.log_level:
    description: "Log level"
    default: "info"

  ha_proxy.connect_timeout:
    description: "Timeout waiting for connections to establish to a server (in seconds)"
    default:     5
  ha_proxy.client_timeout:
    description: "Timeout waiting for data from a client (in seconds)"
    default:     30
  ha_proxy.server_timeout:
    description: "Timeout waiting for data from a server (in seconds)"
    default:     30
  ha_proxy.queue_timeout:
    description: "Timeout for requests queued waiting for free connection slots (in seconds)"
    default:     30

  ha_proxy.stats_enable:
    description: "If true, haproxy will enable a socket for stats. You can see the stats on haproxy_ip:9000/haproxy_stats"
    default: false
  ha_proxy.stats_bind:
    description: "Define one or several listening addresses and/or ports in a frontend."
    default: "*:9000"
  ha_proxy.stats_user:
    description: "User name to authenticate haproxy stats"
  ha_proxy.stats_password:
    description: "Password to authenticate haproxy stats"
  ha_proxy.stats_uri:
    description: "URI used to access the stats UI."
    default: "haproxy_stats"
  ha_proxy.trusted_stats_cidrs:
    description: "Trusted ip range that can access the stats UI"
    default: 0.0.0.0/32

  ha_proxy.tcp:
    description: "List of mappings to perform tcp-based proxying on. See example for mapping datastructure and keys"
    default: []
    example:
      tcp:
        - name:  stuff
          proxy: 1234
          port:  1234
          servers:
          - 10.20.10.10
          - 10.20.10.11
